{% extends "base.html" %}

{% block title %}All Posts - Flask Blog{% endblock %}

{% block content %}
<h1>All Blog Posts</h1>

{% if posts %}
    {% for post in posts %}
    <div class="card">
        <h2><a href="{{ url_for('view_post', post_id=post.id) }}" style="color: #284360; text-decoration: none;">{{ post.title }}</a></h2>
        <div class="post-meta">
            By <strong>{{ post.author.username }}</strong> on {{ post.created_at.strftime('%B %d, %Y at %I:%M %p') }}
            {% if post.updated_at > post.created_at %}
                (Updated: {{ post.updated_at.strftime('%B %d, %Y') }})
            {% endif %}
        </div>
        <p style="margin-top: 15px;">{{ post.content[:300] }}{% if post.content|length > 300 %}...{% endif %}</p>
        <div style="margin-top: 15px;">
            <a href="{{ url_for('view_post', post_id=post.id) }}" class="btn">Read More</a>
            {% if current_user.is_authenticated and current_user.id == post.author_id %}
                <a href="{{ url_for('edit_post', post_id=post.id) }}" class="btn btn-secondary" style="margin-left: 10px;">Edit</a>
            {% endif %}
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="card">
        <p>No posts available yet.</p>
    </div>
{% endif %}
{% endblock %}